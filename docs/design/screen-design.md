# 画面設計書

## 1. 画面一覧
| 画面ID | 画面名 | 説明 |
| :--- | :--- | :--- |
| S01 | 買い物リスト画面 | アプリケーションのメイン画面。リストの閲覧、追加、削除、完了切り替えを行う。 |

## 2. 画面詳細: S01 買い物リスト画面

### 2.1. 概要
ユーザーが買い物リストを管理するためのシングルページアプリケーション。
LIFF (LINE Front-end Framework) を使用して、LINEプラットフォーム上でユーザー認証を行います。

### 2.2. 環境変数

| 変数名 | 説明 | 必須 |
| :--- | :--- | :--- |
| `VITE_LIFF_ID` | LIFF アプリケーション ID | はい |

### 2.3. LIFF連携

#### LIFF初期化フロー
1. アプリケーション起動時に `liff.init()` を呼び出し、LIFF SDKを初期化
2. ログイン状態を確認 (`liff.isLoggedIn()`)
3. ログイン済みの場合、`liff.getProfile()` でユーザープロフィールを取得
4. 取得した LINE User ID をAPIリクエストの `X-Line-User-Id` ヘッダーに付与

#### APIリクエストヘッダー
ログイン済みユーザーの場合、以下のカスタムヘッダーがAPIリクエストに付与されます:
```
X-Line-User-Id: <LINE User ID>
```

#### エラーハンドリング
- **LIFF初期化失敗時**: エラーメッセージを画面中央に赤字で表示
  - 発生しうるエラー:
    - ネットワークエラー (LIFF SDKの読み込み失敗)
    - 無効なLIFF ID (環境変数 `VITE_LIFF_ID` の設定ミス)
    - LINEアプリ外での実行 (LIFFの一部機能が制限)
  - 表示されるメッセージ例: `LIFF Init Failed`

### 2.4. UIコンポーネント構成

#### A. ヘッダー
- **表示内容**:
    - アプリケーションタイトル「買い物リスト」
    - エラー表示領域 (LIFF初期化に失敗した場合のみ、赤字でエラーメッセージを表示。例: `LIFF Init Failed`)
- **スタイル**: 中央揃え、太字 (タイトル)、赤字 (エラーメッセージ)

#### B. アイテム追加フォーム (`AddItemForm`)
- **入力フィールド**:
    - プレースホルダー: "新しいアイテムを追加..."
    - フォーカス時: インディゴ色のリング表示
- **追加ボタン**:
    - ラベル: "追加"
    - 状態: 入力フィールドが空の場合は無効化 (disabled)
    - アクション: クリックまたはEnterキーでアイテムをリストに追加

#### C. 買い物リスト (`ShoppingList`)
- **表示内容**: 登録されたアイテムの一覧
- **リスト項目 (`ShoppingListItem`)**:
    - **チェックボックス (カスタムデザイン)**:
        - 未完了: グレーの枠線
        - 完了: インディゴ色の背景 + チェックマーク
        - アクション: クリックで完了/未完了を切り替え
    - **テキスト**:
        - 未完了: 通常表示
        - 完了: 取り消し線 + グレーアウト
    - **削除ボタン**:
        - 表示条件: **完了 (チェック済み) の項目のみ表示**
        - アイコン: ゴミ箱マーク
        - アクション: クリックでアイテムを削除

### 2.5. 動作仕様
- **初期表示**: LIFF初期化後、サーバーから最新のリストを取得して表示 (`GET /lists/{listId}`)
- **自動更新**: 5秒ごとに最新のリストを自動取得 (ポーリング)
- **アイテム追加**: アイテムを追加すると、即座にリストに反映され、サーバーに送信される (`POST`)
- **完了切り替え**: チェックボックスをクリックすると、即座に見た目が変わり、サーバーに更新が送信される (`PUT`)
- **削除**: 削除ボタンをクリックすると、リストから消去され、サーバーに削除リクエストが送信される (`DELETE`)
